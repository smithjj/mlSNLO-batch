2D-mix-LP is similar to PW-mix-LP except it handles the full spatial profiles so it can realistically model circular or elliptical beams with Gaussian or Supergaussian transverse profiles.  It includes diffraction, birefringent walkoff, displaced beams, etc. for gaussian or super-guassian pulses or cw light. The light is assumed to be monochromatic and the pulses are assumed to be long enough that group velocity effects are unimportant. Maxwell's equations are integrated using split-step methods to give true diffractive calculations. For help in setting input values, right-click on the input edit box. Help text appears in the lower text box.

To specify temporal profiles, use an optional second argument in the pulse duration input box (with the two arguments separated by a space). The second argument should be an integer 0-10, where 0 represents a hyperbolic secant temporal shape, and 1-10 are super Gaussian temporal shapes of order specified (1 for normal Gaussian temporal profile).

Modeling methods are described in detail in papers "Phase distortions in sum- and difference-frequency mixing in crystals" JOSA B vol. 12 p. 49 (1995), and "Comparison of a numerical model with measured performance of a seeded, nanosecond KTP optical parametric oscillator," JOSA B vol. 12 p. 2253 (1995). These papers are available online at http://www.as-photonics.com/Publications.html

The maximum size of the transverse grid depends on the amount of memory available to SNLO. For 12 MB, the grid can be as large as 128x128, for 180 MB it can be up to 512x512. A 32x32 grid is usually adequate.  I suggest you first use the much faster PW-mix-LP to find reasonable values for the input parameters.

Outputs include beam tilts in the walkoff direction (Tilt-w), time dependent M-squared values in the walkoff direction and perpendicular to it (M-w and M-p), time integrated M-squared values (written at top of plots of time-dependent M-squares), and radius of curvature or wavefront curvature (Focus-w and Focus-p) at the plane specified by the propagation distance input parameter. Negative values of radius of curvature indicate a beam is diverging. You should make sure these results are converged by increasing the grid density by factors of two until the answers stabilize. Usually a grid of 32x32 or 64x64 is adequate.  Phases are plotted offset by +pi so the range is (0 to 2 pi) instead of (-pi to pi).

The input pulses (if not cw) are all centered at t=0.  Runs start at t=0 and progress to later time.  Times t<0 are not modeled because of the symmetry about t=0.  The results are written to ascii files *_INT.DAT, *_PH.DAT, where INT (PH) files are irradiance (phase) out at each time step with columns x,y,irr(t1),irr(t2),...  The ascii files *_BEAM.DAT, contain time, power, phase, Mx^2, My^2, X-curvature, Y-curvature, and X-tilt in columns 1-8 (x is the walkoff direction). The fluence is written to the ascii file FLUENCE.DAT with columns x, y, red1 fluence, red2 fluence, blue fluence at the propagation distance specified (from exit face of crystal). FLUENC_F.DAT is the relative far field fluence angular distribution with columns x-angle, y-angle, red1 fluence, red2 fluence, blue fluence. Actual x and y angles (in radians) are found by multiplying x-angle or y-angle by the wavelength (in meters) of the red1, red2, or blue wave.  These distributions are Fourier transforms of the fields at the crystal exit face.

Noncollinear phase matching in the critical plane can be faked by using the walkoff parameter.  For example, if the red1's true birefringent walkoff angle is 50 mrad and you want to propagate a tilted blue o-polarized beam without walkoff along this direction, you would specify 50 mrad walkoff for both the red1 and blue beams. You must then compensate by adjusting an o-polarized red2 walkoff to be -50*lamdared2/lamdablue.  In other words, fake walkoff must be compensated to maintain phasematch, but real birefringent walkoff is not compensated.  Of course, the Tilt-w outputs will not reflect the actual values for the fake walkoff but will be the deviations from the input beam tilts.

Last used input set is saved in mix.mat so if you would like to save those settings for later recall, copy mix.mat to another file name. Copy the file back to mix.mat to restore.

If you are running mlSNLO under MATLAB (not the standalone compiled version), this function can be called from a MATLAB script to automate parametric studies. See the 'SNLO' help tab for details.

2D-mix-LP examples: 9, 14, 24, 26, 38, 43, 44, 58, 60-62. See file Examples with exercises and descriptions.pdf in mlSNLO folder, or on our website at as-photonics.com/examples

Detailed discussions of crystal nonlinear optics and SNLO examples are presented in the book "Crystal nonlinear optics: with SNLO examples," advertised on the SNLO download page or at as-photonics.com/book